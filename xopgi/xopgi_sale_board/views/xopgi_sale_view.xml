<?xml version="1.0"?>
<openerp>
  <data>
    <!-- Opportunities Search View -->

    <!-- Opportunities Search View -->
    <record model="ir.ui.view" id="crm_opportunity_partner_filter">
      <field name="name">crm.opportunity.partner.filter.assigned</field>
      <field name="model">crm.lead</field>
      <field name="inherit_id" ref="crm.view_crm_case_opportunities_filter"/>
      <field name="arch" type="xml">
        <filter name="unassigned" position="after">
          <separator/>
          <filter string="Today Activities" name="today"
                  domain="[('date_action', '=', context_today().strftime('%Y-%m-%d'))]"/>
          <filter string="This Week Activities" name="this_week"
                  domain="['&amp;', ('date_action', '&gt;=', context_today().strftime('%Y-%m-%d')),
                                   ('date_action', '&lt;=', (context_today()+datetime.timedelta(days=7)).strftime('%Y-%m-%d'))
                          ]"/>
          <filter string="Overdue Activities" name="overdue"
                  domain="[('date_action', '&lt;', context_today().strftime('%Y-%m-%d'))]"/>
        </filter>
      </field>
    </record>

    <record id="crm_lead_action_activities" model="ir.actions.act_window">
      <field name="name">Next Activities</field>
      <field name="type">ir.actions.act_window</field>
      <field name="res_model">crm.lead</field>
      <field name="view_mode">tree,form,kanban,calendar,pivot,graph</field>
      <field name="search_view_id"
             ref="crm.view_crm_case_opportunities_filter"/>
      <field name="domain">[('type','=','opportunity')]</field>
      <field name="context">{
        'default_type': 'opportunity',
        'default_user_id': uid,
        'search_default_assigned_to_me': 1
        }
      </field>
      <field name="help" type="html">
        <p>
          Here is the list of your next activities. Those are linked to your
          opportunities.
          To set a next activity, go on an opportunity and add one. It will
          then appear in this list.
        </p>
      </field>
    </record>
  </data>
</openerp>
